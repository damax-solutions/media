<?xml version="1.0" ?>
<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>

        <defaults autowire="true" autoconfigure="true" public="false" />

        <prototype namespace="Damax\Media\Bridge\Symfony\Bundle\Controller\" resource="../../Controller">
            <tag name="controller.service_arguments" />
        </prototype>

        <prototype namespace="Damax\Media\Bridge\Symfony\Bundle\Listener\" resource="../../Listener" />

        <!-- Forms -->

        <prototype namespace="Damax\Media\Bridge\Symfony\Bundle\Form\" resource="../../Form" />

        <!-- Validators -->

        <prototype namespace="Damax\Media\Bridge\Symfony\Validator\Constraints\" resource="../../../Validator/Constraints" />

        <!-- Twig -->

        <prototype namespace="Damax\Media\Bridge\Twig\" resource="../../../../Twig" />

        <!-- Application -->

        <prototype namespace="Damax\Media\Application\Service\" resource="../../../../../Application/Service" />

        <service id="Damax\Media\Application\Dto\Assembler" />

        <!-- Domain -->

        <service id="Damax\Media\Domain\Model\MediaFactory" class="Damax\Media\Domain\Model\ConfigurableMediaFactory" />

        <service id="Damax\Media\Domain\Storage\ExtensionGuesser" class="Damax\Media\Domain\Storage\SymfonyExtensionGuesser" />

        <service id="Damax\Media\Domain\Metadata\Reader" class="Damax\Media\Domain\Metadata\Collector">
            <argument type="tagged" tag="damax.media.reader" />
        </service>

        <service id="Damax\Media\Domain\FileFormatter" />

        <!-- Types -->

        <service id="Damax\Media\Type\Types" />

        <!-- Flysystem -->

        <service id="Damax\Media\Flysystem\Registry" class="Damax\Media\Flysystem\ContainerRegistry" />

        <!-- Reader -->

        <service id="Damax\Media\Metadata\GdImageReader">
            <tag name="damax.media.reader" />
        </service>

    </services>
</container>
